# NFL Decision Maker

This is a project where I try and create a game manager for NFL teams.

There are several steps to this process with the first one being gathering play-by-play data which I do via the data found here: https://github.com/nflverse/nflverse-data/

With this data I load, clean and prepare it as needed in the `data_load.py` file to be ready for training. The goal is to have a 3 step approach and I will be updating this project as I accomplish these steps. The first step is to have an accurate win probability calculator based on given game states i.e. the Bills are 4th and 3 at their own 30 yard line with 3:40 left in the 4th quarter and down by 7 against the Chiefs. To get these win probabilities I use a few different models. Combining the results of a neural network as well as simple linear regression, I get a score differential predictor and using that score differential predictor I use a logistic regression model to turn that into a win probability. All of the model training for these three models is done in `win_prob_model.py` where the neural network architecture as well as the features included in the models are specified in a YAML config and the results are saved to be used for future scripts. Then I have the `predict_win_prob.py` script which allows me to get the predictions from my models by inputting the config used to produce those models and passing a pandas dataframe with the features needed to make the prediction. Below is a link to a video where I do a little walkthrough of this portion of the project as everything up until this point is completed and working: https://youtu.be/EN75Z5_HPhU

The following step (step 2) will be to use these win probabilities and make a decision for teams given their game state as to whether or not they should go for it on 4th down. What prompted this project in the first place was how everyone talks about the analytics pointing towards going for it more than teams actually do, so I wanted a way to see how stark that contrast is. I will probably once this step is completed include a comparison as to how often my model says to go for it vs how often teams actually do so and see if that changes over time because it seems as though the NFL is trending towards analytics.

Step 3 will be to add onto this decision making but have it incorporate play calling as well. Obviously I don't know or have the data to use specific plays that teams run to advise that, but a simple decision maker along the lines of pass, run, kick or punt would be a VERY basic version of what a head coach does in the NFL. It'd be interesting to then look at how closely the model calls games to coaches in the NFL and maybe see if the coaches that behave more similarly to the model have more or less success than those that deviate more.
